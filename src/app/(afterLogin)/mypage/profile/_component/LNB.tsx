"use client";

import { getMyProjectApi } from "@/apis/project/projectApis";
import { getUserInfoApi } from "@/apis/user/userApis";
import Button from "@/components/Button";
import { useQuery } from "@tanstack/react-query";
import { useRouter } from "next/navigation";

export default function LNB() {
    const router = useRouter();

    const { data: user } = useQuery({
        queryKey: ["isLoggedIn"],
        queryFn: getUserInfoApi,
        refetchInterval: 5 * 60 * 1000, // 5분마다 리페치
    });

    const { data: projectData, isPending } = useQuery({
        queryKey: ["myProjects", 1],
        queryFn: getMyProjectApi,
        refetchInterval: 5 * 60 * 1000, // 5분마다 리페치
    });

    const tabCnt = {
        RECRUITING: projectData?.projects?.RECRUITING?.length || 0,
        IN_PROGRESS: projectData?.projects?.IN_PROGRESS?.length || 0,
        COMPLETED: projectData?.projects?.COMPLETED?.length || 0,
        LIKED: projectData?.projects?.LIKED?.length || 0,
    };

    return (
        <div className="w-[300px] h-fit border border-n500 rounded-xl px-6 py-10 fixed top-[112px] left-[calc((100%-1200px)/2)] z-10 bg-white">
            <div className="flex flex-col items-center mb-6">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="1.07143" y="1.07143" width="77.8571" height="77.8571" rx="38.9286" fill="white" />
                    <rect x="1.07143" y="1.07143" width="77.8571" height="77.8571" rx="38.9286" stroke="#D8DAE5" strokeWidth="2.14286" />
                    <path
                        opacity="0.2"
                        d="M38.125 34.375C38.125 35.1167 37.9051 35.8417 37.493 36.4584C37.081 37.0751 36.4953 37.5557 35.8101 37.8395C35.1248 38.1234 34.3708 38.1976 33.6434 38.0529C32.916 37.9083 32.2478 37.5511 31.7234 37.0267C31.1989 36.5022 30.8418 35.834 30.6971 35.1066C30.5524 34.3792 30.6266 33.6252 30.9105 32.9399C31.1943 32.2547 31.6749 31.669 32.2916 31.257C32.9083 30.8449 33.6333 30.625 34.375 30.625C35.3696 30.625 36.3234 31.0201 37.0267 31.7233C37.7299 32.4266 38.125 33.3804 38.125 34.375ZM45.625 30.625C44.8833 30.625 44.1583 30.8449 43.5416 31.257C42.9249 31.669 42.4443 32.2547 42.1605 32.9399C41.8766 33.6252 41.8024 34.3792 41.9471 35.1066C42.0918 35.834 42.4489 36.5022 42.9734 37.0267C43.4978 37.5511 44.166 37.9083 44.8934 38.0529C45.6208 38.1976 46.3748 38.1234 47.0601 37.8395C47.7453 37.5557 48.331 37.0751 48.743 36.4584C49.1551 35.8417 49.375 35.1167 49.375 34.375C49.375 33.3804 48.9799 32.4266 48.2767 31.7233C47.5734 31.0201 46.6196 30.625 45.625 30.625ZM34.375 41.875C33.6333 41.875 32.9083 42.0949 32.2916 42.507C31.6749 42.919 31.1943 43.5047 30.9105 44.1899C30.6266 44.8752 30.5524 45.6292 30.6971 46.3566C30.8418 47.084 31.1989 47.7522 31.7234 48.2767C32.2478 48.8011 32.916 49.1583 33.6434 49.3029C34.3708 49.4476 35.1248 49.3734 35.8101 49.0896C36.4953 48.8057 37.081 48.3251 37.493 47.7084C37.9051 47.0917 38.125 46.3667 38.125 45.625C38.125 44.6304 37.7299 43.6766 37.0267 42.9734C36.3234 42.2701 35.3696 41.875 34.375 41.875Z"
                        fill="#C1C4D6"
                    />
                    <path
                        d="M34.375 29.6875C33.4479 29.6875 32.5416 29.9624 31.7708 30.4775C30.9999 30.9926 30.3991 31.7246 30.0443 32.5812C29.6895 33.4377 29.5967 34.3802 29.7776 35.2895C29.9584 36.1988 30.4049 37.034 31.0604 37.6896C31.716 38.3451 32.5512 38.7916 33.4605 38.9724C34.3698 39.1533 35.3123 39.0605 36.1688 38.7057C37.0254 38.3509 37.7574 37.7501 38.2725 36.9792C38.7876 36.2084 39.0625 35.3021 39.0625 34.375C39.0625 33.1318 38.5686 31.9395 37.6896 31.0604C36.8105 30.1814 35.6182 29.6875 34.375 29.6875ZM34.375 37.1875C33.8187 37.1875 33.275 37.0226 32.8125 36.7135C32.3499 36.4045 31.9895 35.9652 31.7766 35.4513C31.5637 34.9374 31.508 34.3719 31.6165 33.8263C31.7251 33.2807 31.9929 32.7796 32.3863 32.3863C32.7796 31.9929 33.2807 31.7251 33.8263 31.6165C34.3719 31.508 34.9374 31.5637 35.4513 31.7766C35.9652 31.9895 36.4045 32.3499 36.7135 32.8125C37.0226 33.275 37.1875 33.8187 37.1875 34.375C37.1875 35.1209 36.8912 35.8363 36.3637 36.3637C35.8363 36.8912 35.1209 37.1875 34.375 37.1875ZM45.625 39.0625C46.5521 39.0625 47.4584 38.7876 48.2292 38.2725C49.0001 37.7574 49.6009 37.0254 49.9557 36.1688C50.3105 35.3123 50.4033 34.3698 50.2224 33.4605C50.0416 32.5512 49.5951 31.716 48.9396 31.0604C48.284 30.4049 47.4488 29.9584 46.5395 29.7776C45.6302 29.5967 44.6877 29.6895 43.8312 30.0443C42.9746 30.3991 42.2426 30.9999 41.7275 31.7708C41.2124 32.5416 40.9375 33.4479 40.9375 34.375C40.9375 35.6182 41.4314 36.8105 42.3104 37.6896C43.1895 38.5686 44.3818 39.0625 45.625 39.0625ZM45.625 31.5625C46.1813 31.5625 46.725 31.7275 47.1875 32.0365C47.6501 32.3455 48.0105 32.7848 48.2234 33.2987C48.4363 33.8126 48.492 34.3781 48.3835 34.9237C48.2749 35.4693 48.0071 35.9704 47.6137 36.3637C47.2204 36.7571 46.7193 37.0249 46.1737 37.1335C45.6281 37.242 45.0626 37.1863 44.5487 36.9734C44.0348 36.7605 43.5955 36.4001 43.2865 35.9375C42.9775 35.475 42.8125 34.9313 42.8125 34.375C42.8125 33.6291 43.1088 32.9137 43.6363 32.3863C44.1637 31.8588 44.8791 31.5625 45.625 31.5625ZM34.375 40.9375C33.4479 40.9375 32.5416 41.2124 31.7708 41.7275C30.9999 42.2426 30.3991 42.9746 30.0443 43.8312C29.6895 44.6877 29.5967 45.6302 29.7776 46.5395C29.9584 47.4488 30.4049 48.284 31.0604 48.9396C31.716 49.5951 32.5512 50.0416 33.4605 50.2224C34.3698 50.4033 35.3123 50.3105 36.1688 49.9557C37.0254 49.6009 37.7574 49.0001 38.2725 48.2292C38.7876 47.4584 39.0625 46.5521 39.0625 45.625C39.0625 44.3818 38.5686 43.1895 37.6896 42.3104C36.8105 41.4314 35.6182 40.9375 34.375 40.9375ZM34.375 48.4375C33.8187 48.4375 33.275 48.2726 32.8125 47.9635C32.3499 47.6545 31.9895 47.2152 31.7766 46.7013C31.5637 46.1874 31.508 45.6219 31.6165 45.0763C31.7251 44.5307 31.9929 44.0296 32.3863 43.6363C32.7796 43.2429 33.2807 42.9751 33.8263 42.8665C34.3719 42.758 34.9374 42.8137 35.4513 43.0266C35.9652 43.2395 36.4045 43.5999 36.7135 44.0625C37.0226 44.525 37.1875 45.0687 37.1875 45.625C37.1875 46.3709 36.8912 47.0863 36.3637 47.6137C35.8363 48.1412 35.1209 48.4375 34.375 48.4375ZM50.3125 45.625C50.3125 45.8736 50.2137 46.1121 50.0379 46.2879C49.8621 46.4637 49.6236 46.5625 49.375 46.5625H46.5625V49.375C46.5625 49.6236 46.4637 49.8621 46.2879 50.0379C46.1121 50.2137 45.8736 50.3125 45.625 50.3125C45.3764 50.3125 45.1379 50.2137 44.9621 50.0379C44.7863 49.8621 44.6875 49.6236 44.6875 49.375V46.5625H41.875C41.6264 46.5625 41.3879 46.4637 41.2121 46.2879C41.0363 46.1121 40.9375 45.8736 40.9375 45.625C40.9375 45.3764 41.0363 45.1379 41.2121 44.9621C41.3879 44.7863 41.6264 44.6875 41.875 44.6875H44.6875V41.875C44.6875 41.6264 44.7863 41.3879 44.9621 41.2121C45.1379 41.0363 45.3764 40.9375 45.625 40.9375C45.8736 40.9375 46.1121 41.0363 46.2879 41.2121C46.4637 41.3879 46.5625 41.6264 46.5625 41.875V44.6875H49.375C49.6236 44.6875 49.8621 44.7863 50.0379 44.9621C50.2137 45.1379 50.3125 45.3764 50.3125 45.625Z"
                        fill="#C1C4D6"
                    />
                </svg>

                <div className="my-3 text-h3 text-n900">{user?.name}</div>

                <div className="flex items-center gap-2 text-sm text-n800 mb-6">
                    <div>{user?.job || "직업 미정"}</div>
                    <div className="w-[1px] h-[15.5px] bg-n300"></div>
                    <div>경력 {user?.career || 0}년</div>
                </div>

                <Button
                    label="프로필 수정"
                    btnType="line"
                    size="small"
                    onClick={() => {
                        router.push("/mypage/profile/edit");
                    }}
                />
            </div>

            <div className="w-full border border-n400 rounded-lg px-5 py-4 grid grid-cols-4 gap-2.5">
                <div className="flex flex-col items-center">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className="mb-2">
                        <path
                            d="M12 2.25C10.0716 2.25 8.18657 2.82183 6.58319 3.89317C4.97982 4.96451 3.73013 6.48726 2.99218 8.26884C2.25422 10.0504 2.06114 12.0108 2.43735 13.9021C2.81355 15.7934 3.74215 17.5307 5.10571 18.8943C6.46928 20.2579 8.20656 21.1865 10.0979 21.5627C11.9892 21.9389 13.9496 21.7458 15.7312 21.0078C17.5127 20.2699 19.0355 19.0202 20.1068 17.4168C21.1782 15.8134 21.75 13.9284 21.75 12C21.7473 9.41498 20.7192 6.93661 18.8913 5.10872C17.0634 3.28084 14.585 2.25273 12 2.25ZM6.945 18.5156C7.48757 17.6671 8.23501 16.9688 9.11843 16.4851C10.0019 16.0013 10.9928 15.7478 12 15.7478C13.0072 15.7478 13.9982 16.0013 14.8816 16.4851C15.765 16.9688 16.5124 17.6671 17.055 18.5156C15.6097 19.6397 13.831 20.2499 12 20.2499C10.169 20.2499 8.39032 19.6397 6.945 18.5156ZM9 11.25C9 10.6567 9.17595 10.0766 9.5056 9.58329C9.83524 9.08994 10.3038 8.70542 10.852 8.47836C11.4001 8.2513 12.0033 8.19189 12.5853 8.30764C13.1672 8.4234 13.7018 8.70912 14.1213 9.12868C14.5409 9.54824 14.8266 10.0828 14.9424 10.6647C15.0581 11.2467 14.9987 11.8499 14.7716 12.3981C14.5446 12.9462 14.1601 13.4148 13.6667 13.7444C13.1734 14.0741 12.5933 14.25 12 14.25C11.2044 14.25 10.4413 13.9339 9.87868 13.3713C9.31607 12.8087 9 12.0456 9 11.25ZM18.165 17.4759C17.3285 16.2638 16.1524 15.3261 14.7844 14.7806C15.5192 14.2019 16.0554 13.4085 16.3184 12.5108C16.5815 11.6132 16.5582 10.6559 16.252 9.77207C15.9457 8.88825 15.3716 8.12183 14.6096 7.5794C13.8475 7.03696 12.9354 6.74548 12 6.74548C11.0646 6.74548 10.1525 7.03696 9.39044 7.5794C8.62839 8.12183 8.05432 8.88825 7.74805 9.77207C7.44179 10.6559 7.41855 11.6132 7.68157 12.5108C7.94459 13.4085 8.4808 14.2019 9.21563 14.7806C7.84765 15.3261 6.67147 16.2638 5.835 17.4759C4.77804 16.2873 4.0872 14.8185 3.84567 13.2464C3.60415 11.6743 3.82224 10.0658 4.47368 8.61478C5.12512 7.16372 6.18213 5.93192 7.51745 5.06769C8.85276 4.20346 10.4094 3.74367 12 3.74367C13.5906 3.74367 15.1473 4.20346 16.4826 5.06769C17.8179 5.93192 18.8749 7.16372 19.5263 8.61478C20.1778 10.0658 20.3959 11.6743 20.1543 13.2464C19.9128 14.8185 19.222 16.2873 18.165 17.4759Z"
                            fill="#8F95B2"
                        />
                    </svg>
                    <div className="text-base text-n700 mb-1">모집중</div>
                    <div className="text-baseEmphasize text-n700">{tabCnt.RECRUITING}개</div>
                </div>
                <div className="flex flex-col items-center">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className="mb-2">
                        <path
                            d="M20.25 6.75H12.2503L9.64969 4.8C9.38967 4.60599 9.07411 4.5008 8.74969 4.5H3.75C3.35218 4.5 2.97064 4.65804 2.68934 4.93934C2.40804 5.22064 2.25 5.60218 2.25 6V18.75C2.25 19.1478 2.40804 19.5294 2.68934 19.8107C2.97064 20.092 3.35218 20.25 3.75 20.25H20.3334C20.709 20.2495 21.069 20.1001 21.3346 19.8346C21.6001 19.569 21.7495 19.209 21.75 18.8334V8.25C21.75 7.85218 21.592 7.47064 21.3107 7.18934C21.0294 6.90804 20.6478 6.75 20.25 6.75ZM20.25 18.75H3.75V6H8.74969L11.55 8.1C11.6798 8.19737 11.8377 8.25 12 8.25H20.25V18.75Z"
                            fill="#8F95B2"
                        />
                    </svg>

                    <div className="text-base text-n700 mb-1">진행중</div>
                    <div className="text-baseEmphasize text-n700">{tabCnt.IN_PROGRESS}개</div>
                </div>
                <div className="flex flex-col items-center">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className="mb-2">
                        <path
                            d="M16.2806 9.21937C16.3504 9.28903 16.4057 9.37175 16.4434 9.46279C16.4812 9.55384 16.5006 9.65144 16.5006 9.75C16.5006 9.84856 16.4812 9.94616 16.4434 10.0372C16.4057 10.1283 16.3504 10.211 16.2806 10.2806L11.0306 15.5306C10.961 15.6004 10.8783 15.6557 10.7872 15.6934C10.6962 15.7312 10.5986 15.7506 10.5 15.7506C10.4014 15.7506 10.3038 15.7312 10.2128 15.6934C10.1218 15.6557 10.039 15.6004 9.96938 15.5306L7.71938 13.2806C7.57865 13.1399 7.49959 12.949 7.49959 12.75C7.49959 12.551 7.57865 12.3601 7.71938 12.2194C7.86011 12.0786 8.05098 11.9996 8.25 11.9996C8.44903 11.9996 8.6399 12.0786 8.78063 12.2194L10.5 13.9397L15.2194 9.21937C15.289 9.14964 15.3718 9.09432 15.4628 9.05658C15.5538 9.01884 15.6514 8.99941 15.75 8.99941C15.8486 8.99941 15.9462 9.01884 16.0372 9.05658C16.1283 9.09432 16.211 9.14964 16.2806 9.21937ZM21.75 12C21.75 13.9284 21.1782 15.8134 20.1068 17.4168C19.0355 19.0202 17.5127 20.2699 15.7312 21.0078C13.9496 21.7458 11.9892 21.9389 10.0979 21.5627C8.20656 21.1865 6.46928 20.2579 5.10571 18.8943C3.74215 17.5307 2.81355 15.7934 2.43735 13.9021C2.06114 12.0108 2.25422 10.0504 2.99218 8.26884C3.73013 6.48726 4.97982 4.96451 6.58319 3.89317C8.18657 2.82183 10.0716 2.25 12 2.25C14.585 2.25273 17.0634 3.28084 18.8913 5.10872C20.7192 6.93661 21.7473 9.41498 21.75 12ZM20.25 12C20.25 10.3683 19.7661 8.77325 18.8596 7.41655C17.9531 6.05984 16.6646 5.00242 15.1571 4.37799C13.6497 3.75357 11.9909 3.59019 10.3905 3.90852C8.79017 4.22685 7.32016 5.01259 6.16637 6.16637C5.01259 7.32015 4.22685 8.79016 3.90853 10.3905C3.5902 11.9908 3.75358 13.6496 4.378 15.1571C5.00242 16.6646 6.05984 17.9531 7.41655 18.8596C8.77326 19.7661 10.3683 20.25 12 20.25C14.1873 20.2475 16.2843 19.3775 17.8309 17.8309C19.3775 16.2843 20.2475 14.1873 20.25 12Z"
                            fill="#8F95B2"
                        />
                    </svg>

                    <div className="text-base text-n700 mb-1">완료</div>
                    <div className="text-baseEmphasize text-n700">{tabCnt.COMPLETED}개</div>
                </div>
                <div className="flex flex-col items-center">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className="mb-2">
                        <path
                            d="M16.6875 3.75C14.7516 3.75 13.0566 4.5825 12 5.98969C10.9434 4.5825 9.24844 3.75 7.3125 3.75C5.77146 3.75174 4.29404 4.36468 3.20436 5.45436C2.11468 6.54404 1.50174 8.02146 1.5 9.5625C1.5 16.125 11.2303 21.4369 11.6447 21.6562C11.7539 21.715 11.876 21.7458 12 21.7458C12.124 21.7458 12.2461 21.715 12.3553 21.6562C12.7697 21.4369 22.5 16.125 22.5 9.5625C22.4983 8.02146 21.8853 6.54404 20.7956 5.45436C19.706 4.36468 18.2285 3.75174 16.6875 3.75ZM12 20.1375C10.2881 19.14 3 14.5959 3 9.5625C3.00149 8.41921 3.45632 7.32317 4.26475 6.51475C5.07317 5.70632 6.16921 5.25149 7.3125 5.25C9.13594 5.25 10.6669 6.22125 11.3062 7.78125C11.3628 7.91881 11.4589 8.03646 11.5824 8.11926C11.7059 8.20207 11.8513 8.24627 12 8.24627C12.1487 8.24627 12.2941 8.20207 12.4176 8.11926C12.5411 8.03646 12.6372 7.91881 12.6937 7.78125C13.3331 6.21844 14.8641 5.25 16.6875 5.25C17.8308 5.25149 18.9268 5.70632 19.7353 6.51475C20.5437 7.32317 20.9985 8.41921 21 9.5625C21 14.5884 13.71 19.1391 12 20.1375Z"
                            fill="#8F95B2"
                        />
                    </svg>

                    <div className="text-base text-n700 mb-1">찜</div>
                    <div className="text-baseEmphasize text-n700">{tabCnt.LIKED}개</div>
                </div>
            </div>
        </div>
    );
}
